#!/bin/bash

### contact: hets-devel@informatik.uni-bremen.de

### a script that sets all HETS_*- and UNI*-variables according to the
### installation directory or according binaries found during the
### installation;
### it is post processed by some IzPack variables starting with %

if [ -d $INSTALL_PATH/lib/uDrawGraph ] ; then
    UDG_HOME=$INSTALL_PATH/lib/uDrawGraph
else 
    if [ ! -d "$UDG_HOME" ] ; then
	if [ -f "$UNIDAVINCI" ] ; then
	    UDG_HOME=`dirname $UNIDAVINCI 2> /dev/null`/..
	else if [ -f "$UDRAWGRAPH_PATH" ] ; then
	        UDG_HOME=`dirname $UDRAWGRAPH_PATH 2> /dev/null`/..
	     else
	       UDG_HOME=`dirname \`which uDrawGraph\` 2> /dev/null`/..
	     fi
	fi
    fi
fi
UNIDAVINCI=$UDG_HOME/bin/uDrawGraph

if [ -d $INSTALL_PATH/lib/Isabelle* ] ; then
    ISABELLE_HOME=$INSTALL_PATH/lib/Isabelle/
else if [ ! -d "$ISABELLE_HOME" ] ; then
         if [ -f "$ISABELLE_PATH" ] ; then
	     ISABELLE_HOME=`dirname $ISABELLE_PATH 2> /dev/null`/../../
	  else ISABELLE_HOME=`dirname \`which isabelle\` 2> /dev/null`/../..
	 fi
     fi
fi

if [ -z "$HETS_ISABELLE" ] ; then
    case `uname -s` in
	Darwin) HETS_ISABELLE="$ISABELLE_HOME/Isabelle/bin/isabelle-interface -p /Applications/Emacs.app/Contents/MacOS/Emacs ";;
	*) HETS_ISABELLE=$ISABELLE_HOME/Isabelle/bin/isabelle-interface;;
    esac
fi

if [ -d $INSTALL_PATH/Hets-lib ] ; then
    HETS_LIB=$INSTALL_PATH/Hets-lib
fi

HETS_OWL_PARSER=$INSTALL_PATH/lib/hets/
UNIWISH=/usr/bin/wish
HETS=$INSTALL_PATH/lib/hets/hets-$APP_VER
HETS_APROVE=$INSTALL_PATH/lib/hets/java/AProVE.jar

export HETS_LIB ISABELLE_HOME HETS_ISABELLE HETS_OWL_PARSER \
    UNIWISH UNIDAVINCI UDG_HOME HETS_APROVE

if [ -d $INSTALL_PATH/lib/SPASS* ] ; then
    SPASS_DIR=`ls $INSTALL_PATH/lib/ | grep SPASS`
    export PATH=$PATH:$INSTALL_PATH/lib/$SPASS_DIR
else if [ -f "$SPASS_PATH" ] ; then
       SPASS_DIR=`dirname $SPASS_PATH 2> /dev/null`
       export PATH=$PATH:$SPASS_DIR
     fi
fi

export PATH=$PATH:$INSTALL_PATH/bin
exec $HETS $@
